## Introduction:  
As more and more organizations are moving their services to the cloud, authentication and authorization become crucial aspects of their security. Azure Active Directory (Azure AD) is a cloud-based identity and access management service that provides a secure way to manage user identities and access to resources in the cloud. In this blog, we will explore how to create an Azure AD token using Postman, a popular tool for API testing and development. We will start by setting up an Azure AD application, granting permissions to the application, and then using Postman to get an access token. This tutorial is intended for developers who want to learn how to authenticate their API requests to Azure AD using Postman.

## Installation and Setup: 
1. Download and install Postman from the official website: https://www.postman.com/downloads/
2. Once the installation is complete, open Postman and create a new collection to hold your APIs.


## Step1: Define Variables in Postman
Postman allows you to set variables at various levels, you can read all about variables and scopes here: Postman: Using variables https://learning.postman.com/docs/sending-requests/variables/ . In this example, we’ll use “Collection level” variables.
![1.postman_create_token_parameters_values.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/1.postman_create_token_parameters_values.jpg)

Bases on created SPN in Azure initialize these variables.
![2.postman_create_token_parameters_values_mapping_with_spn.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/2.postman_create_token_parameters_values_mapping_with_spn.jpg)

Variable Name	Current Value	Notes  
clientId		This is the value of appId from the service principal creation.  
clientSecret		This is the value of password from the service principal creation.  
tenantId		This is the value of tenantId from the service principal creation.  
subscriptionId		You can get this with this Azure CLI command az account show --query id -o tsv  
resource	https://management.azure.com/	The default value is for managing Azure resources.  
access_token		This is generated by the Pre-request script below. You do not need to set this.  
rest variables can be ignored as of now.  


## Step2: Create GET method with below parameters
Parameterizing is the best way to populate dynamic variable, refer below screenshot and create a GET call.
![3.postman_create_token_parameters.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/3.postman_create_token_parameters.jpg)

refer below screenshot to locate the variables in postman
![4.postman_create_token_parameters_values_mapping.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/4.postman_create_token_parameters_values_mapping.jpg)

Write below script in "Test" tab to to initialize **access_token** variable with the created token
```
var JsonObject = JSON.parse(responseBody);
postman.clearGlobalVariable("access_token");
postman.setGlobalVariable("access_token", JsonObject.access_token);

pm.environment.unset("access_token");
pm.environment.set("access_token", JsonObject.access_token);
```

![4.1.postman_create_token_parameters_values_mapping_script.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/4.1.postman_create_token_parameters_values_mapping_script.jpg)

## Step3: Make a GET call and generate the token
You are all set to make a get call to generate Oauth token. Once the Oauth token is create that Oauth token can be used to make further call on Azure to manage Azure resources.

![5.postman_create_token_generation.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/5.postman_create_token_generation.jpg)


Once the token is created it will be initialize in **access_token** variable.
![6.postman_create_token_generation_initialization.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/6.postman_create_token_generation_initialization.jpg)


## Step4: Make REST calls on Azure manage resource using access_token variable
Once the token is created use access_token variable to make REST calls on Azure to manage resources.
Below screen shot can be referred to make a sample GET call to get created resources in Azure Subscription.
![7.postman_create_token_get_rg_using_token.jpg](https://github.com/PiyushMittl/Others/blob/main/postman-create-az-token/images/7.postman_create_token_get_rg_using_token.jpg)


In this blog, we have learned how to create an Azure AD token using Postman, a popular tool for API testing and development. By setting up an Azure AD application, granting permissions to the application, and using Postman to get an access token, we have demonstrated how to authenticate API requests to Azure AD. This method can be useful for developers who are building applications that require secure access to Azure AD resources. It is important to note that the access token has a limited lifespan, so it is important to refresh it periodically. Additionally, the access token must be kept secure, as it can provide access to sensitive resources. By following best practices for authentication and authorization, developers can ensure that their applications are secure and their users' data is protected.



